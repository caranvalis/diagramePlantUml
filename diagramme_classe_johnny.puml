@startuml
!define RECTANGLE class

' ===== CLASSES PRINCIPALES =====

abstract class Client {
    - id: String
    - numeroNIU: String
    - adresse: String
    - telephone: String
    - email: String
    - nationalite: String
    - personneAContacter: String
    - statut: StatutClient
    - dateCreation: Date
    - dateMiseAJour: Date
    - profilClient: ProfilClient
    - categorieInterne: String
    - categorieBanqueCentrale: String
    - secteurActivite: String
    - estBloque: Boolean
    - estPPE: Boolean
    - estFATCA: Boolean
    - pays: Pays
    + creer(): Boolean
    + modifier(): Boolean
    + bloquer(): Boolean
    + debloquer(): Boolean
    + validerIdentite(): Boolean
}

class ClientParticulier extends Client {
    - nom: String
    - prenoms: String
    - dateNaissance: Date
    - lieuNaissance: String
    - nomPere: String
    - nomMere: String
    - numeroCNI: String
    - dateLivraisonCNI: Date
    - lieuLivraisonCNI: String
    - trancheRevenus: String
    - nomEmployeur: String
    + preEnregistrer(): String
    + genererFicheKYC(): Document
}

class ClientEntreprise extends Client {
    - raisonSociale: String
    - dateCreation: Date
    - numeroRCCM: String
    - capitalSocial: BigDecimal
    - chiffreAffaire: BigDecimal
    - effectif: Integer
    - gerant: ClientParticulier
    - estEnOppositionParDefaut: Boolean
    + gererActionnariat(): Boolean
    + validerGerant(): Boolean
}

class Mandataire {
    - id: String
    - clientParticulier: ClientParticulier
    - typeMandataire: TypeMandataire
    - numeroMandataire: String
    - dateDebut: Date
    - dateFin: Date
    - pouvoirs: String
    - statut: StatutMandataire
    - documentMandataire: Document
    + creer(): Boolean
    + modifier(): Boolean
    + revoquer(): Boolean
    + validerPouvoirs(): Boolean
    + verifierValidite(): Boolean
}

' ===== GESTION DES COMPTES =====

class Compte {
    - numeroCompte: String
    - suffixeCompte: String
    - codeAgence: String
    - codeDevise: String
    - chapitreComptable: String
    - cleControleCompte: String
    - intituleCompte: String
    - codeService: String
    - sensCompte: SensCompte
    - typeCompte: TypeCompte
    - statut: StatutCompte
    - dateCreation: Date
    - dateCloturation: Date
    - rib: RIB
    + creerDansCBS(): Boolean
    + cloturerDansCBS(): Boolean
    + bloquer(): Boolean
    + debloquer(): Boolean
}
' ===== GESTION DOCUMENTAIRE =====

class Document {
    - id: String
    - nom: String
    - typeDocument: TypeDocument
    - chemin: String
    - taille: Long
    - checksum: String
    - dateUpload: Date
    - dateExpiration: Date
    - version: Integer
    - statut: StatutDocument
    - estObligatoire: Boolean
    + valider(): Boolean
    + verifierExpiration(): Boolean
    + verifierAuthenticite(): Boolean
    + archiver(): Boolean
}

' ===== GESTION DES CONTRÔLES =====

abstract class Controle {
    - id: String
    - nom: String
    - description: String
    - priorite: Integer
    - estActif: Boolean
    + executer(): ResultatControle
    + valider(): Boolean
}

class TypeControle {
    - id: String
    - nom: String
    - description: String
    + Creer()
    + modifier()
    + suspendre()
}

class ControleIdentite extends Controle {
    + validerDocuments(): Boolean
    + detecterDoublons(): Boolean
    + verifierDatesExpiration(): Boolean
}

class ControleConformite extends Controle {
    + verifierBlacklist(): Boolean
    + identifierPPE(): Boolean
    + controlerCompletude(): Boolean
    + verifierFATCA(): Boolean
}

' ===== GESTION DES PARCOURS ET ÉTAPES =====

class Parcours {
    - id: String
    - nom: String
    - description: String
    - typeClient: TypeClient
    - typeCompte: TypeCompte
    - version: Integer
    - dateCreation: Date
    - dateMiseAJour: Date
    - estActif: Boolean
    - createur: Utilisateur
    - dureeEstimee: Integer
    + creer(): Boolean
    + modifier(): Boolean
    + activer(): Boolean
    + desactiver(): Boolean
    + dupliquer(): Parcours
    + calculerDuree(): Integer
}

class Etape {
    - id: String
    - nom: String
    - description: String
    - ordre: Integer
    - parcours: Parcours
    - typeEtape: TypeEtape
    - acteurResponsable: TypeActeur
    - dureeEstimee: Integer
    - estObligatoire: Boolean
    - estParallele: Boolean
    - conditionActivation: String
    - actionSuivante: String
    + executer(): Boolean
    + valider(): Boolean
    + rejeter(): String
    + escalader(): Boolean
    + calculerDelai(): Integer
    + verifierConditions(): Boolean
}

' ===== GESTION DES CONTRÔLES AMÉLIORÉE =====

abstract class Controle {
    - id: String
    - nom: String
    - description: String
    - priorite: Integer
    - estActif: Boolean
    + executer(): ResultatControle
    + valider(): Boolean
}

' ===== SYSTÈME DE NOTIFICATION =====

class Notification {
    - id: String
    - titre: String
    - contenu: String
    - typeNotification: TypeNotification
    - priorite: PrioriteNotification
    - statut: StatutNotification
    - dateCreation: Date
    - dateEnvoi: Date
    - dateLecture: Date
    - destinataire: String
    - expediteur: Utilisateur
    - etape: Etape
    + creer(): Boolean
    + envoyer(): Boolean
    + marquerCommelue(): Boolean
    + programmer(): Boolean
    + annuler(): Boolean
}

class Message {
    - id: String
    - notification: Notification
    - canal: Canal
    - contenuFormate: String
    - adresseDestinataire: String
    - statutEnvoi: StatutEnvoi
    - dateEnvoi: Date
    - dateReception: Date
    - nombreTentatives: Integer
    - codeErreur: String
    + formaterContenu(): String
    + envoyer(): Boolean
    + reessayer(): Boolean
    + confirmerReception(): Boolean
}

class TypeNotification {
    - id: String
    - code: String
    - libelle: String
    - description: String
    - template: String
    - estActif: Boolean
    - canauxAutorises: List<Canal>
    + creerTemplate(): String
    + validerTemplate(): Boolean
    + appliquerTemplate(): String
}

class Canal {
    - id: String
    - nom: String
    - typeCanal: TypeCanal
    - configuration: String
    - estActif: Boolean
    - priorite: Integer
    - limiteEnvoi: Integer
    - coutParMessage: BigDecimal
    + configurer(): Boolean
    + tester(): Boolean
    + envoyer(message: Message): Boolean
    + verifierDisponibilite(): Boolean
}

' ===== GESTION DU RÉFÉRENTIEL =====

class Referentiel {
    - id: String
    - nom: String
    - description: String
    - typeReferentiel: TypeReferentiel
    - domaineApplication: DomaineApplication
    - version: Integer
    - dateCreation: Date
    - dateMiseAJour: Date
    - estActif: Boolean
    - pays: Pays
    - regleMetier: String
    + creer(): Boolean
    + modifier(): Boolean
    + valider(): Boolean
    + publier(): Boolean
    + archiver(): Boolean
    + appliquerRegle(): Boolean
}

class TypeReferentiel {
    - id: String
    - code: String
    - libelle: String
    - description: String
    - categorie: String
    - estObligatoire: Boolean
    - periodiciteRevision: Integer
    + definirRegle(): Boolean
    + validerCoherence(): Boolean
}

class DomaineApplication {
    - id: String
    - nom: String
    - description: String
    - perimetre: String
    - responsable: String
    - dateDebut: Date
    - dateFin: Date
    - estActif: Boolean
    + appliquer(): Boolean
    + validerPerimetre(): Boolean
    + etendre(): Boolean
}

' ===== GESTION DES UTILISATEURS =====

class Utilisateur {
    - id: String
    - login: String
    - motDePasseHash: String
    - nom: String
    - prenoms: String
    - email: String
    - telephone: String
    - role: Role
    - agence: String
    - estActif: Boolean
    - derniereConnexion: Date
    + authentifier(): Boolean
    + changerMotDePasse(): Boolean
    + autoriser(action: String): Boolean
}

class Role {
    - id: String
    - nom: String
    - description: String
    - permissions: List<Permission>
    + ajouterPermission(): Boolean
    + retirerPermission(): Boolean
}

class Permission {
    - id: String
    - nom: String
    - module: String
    - action: String
    - ressource: String
}

' ===== AUDIT ET REPORTING =====

class JournalAudit {
    - id: String
    - utilisateur: Utilisateur
    - action: String
    - ressource: String
    - ancienneValeur: String
    - nouvelleValeur: String
    - adresseIP: String
    - dateAction: Date
    - estImmuable: Boolean
    + enregistrer(): Boolean
    + consulter(): List<JournalAudit>
}

' ===== CLASSIFICATION ET ARCHIVAGE =====

class PlanClassification {
    - id: String
    - pays: Pays
    - typeClient: TypeClient
    - arborescence: String
    - codeClassification: String
    - regleDenommage: String
    + genererCode(): String
    + organiserDocuments(): Boolean
}

class Archives {
    - id: String
    - document: Document
    - planClassification: PlanClassification
    - codeRangement: String
    - emplacement: String
    - dateArchivage: Date
    - dureeConservation: Integer
    + archiver(): Boolean
    + rechercher(): List<Document>
    + restaurer(): Boolean
}

' ===== GESTION MULTI-PAYS =====

class Pays {
    - code: String
    - nom: String
    - langue: String
    - formatDate: String
    - reglementations: List<Reglementation>
    - listeSanctions: String
    + appliquerReglementation(): Boolean
    + verifierSanctions(): Boolean
}

class Reglementation {
    - id: String
    - nom: String
    - reference: String
    - description: String
    - dateApplication: Date
    - controles: List<Controle>
}


' ===== RELATIONS AVEC CARDINALITÉS =====

' Relations Client
Client "1" -- "0..*" Compte
Client "1" -- "0..*" Document
ClientParticulier "1" -- "0..*" Mandataire
' ClientEntreprise "1" -- "0..*" ClientParticulier
' ClientEntreprise "1" -- "1" ClientParticulier

' Relations Parcours et Étapes
Parcours "1" -- "1..*" Etape

' Relations Étapes
Etape "1" -- "0..*" Controle
Etape "1" -- "0..*" Notification
Etape "0..*" -- "0..1" Client
Etape "0..*" -- "0..1" Compte

' Relations Contrôles
TypeControle "1" -- "0..*" Controle

' Relations Notifications
Notification "1" -- "1..*" Message
Notification "1" -- "0..*" Canal
Notification "1" -- "0..*" TypeNotification

' Relations Référentiel
Referentiel "0..*" -- "1" TypeReferentiel
Referentiel "0..*" -- "1" DomaineApplication
Referentiel "0..*" -- "1" Pays

' Relations Utilisateur
Utilisateur "0..*" -- "1" Role
Utilisateur "1..*" -- "1" Etape
Role "1" -- "0..*" Permission

' Relations Archives
Document "0..*" -- "1" Archives
Archives "0..*" -- "1" PlanClassification

' Relations Pays
Client "0..*" -- "1" Pays
Pays "1" -- "0..*" Reglementation

@enduml